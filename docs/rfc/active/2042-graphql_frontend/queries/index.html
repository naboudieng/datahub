<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.8">
<link rel="search" type="application/opensearchdescription+xml" title="DataHub" href="/opensearch.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600&display=swap"><title data-react-helmet="true">GraphQL Frontend (Part 1) | DataHub</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://datahubproject.io/docs/rfc/active/2042-graphql_frontend/queries"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="GraphQL Frontend (Part 1) | DataHub"><meta data-react-helmet="true" name="description" content="- Start Date: 12/17/2020"><meta data-react-helmet="true" property="og:description" content="- Start Date: 12/17/2020"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://datahubproject.io/docs/rfc/active/2042-graphql_frontend/queries"><link data-react-helmet="true" rel="alternate" href="https://datahubproject.io/docs/rfc/active/2042-graphql_frontend/queries" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://datahubproject.io/docs/rfc/active/2042-graphql_frontend/queries" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.89705917.css">
<link rel="preload" href="/assets/js/runtime~main.e06da938.js" as="script">
<link rel="preload" href="/assets/js/main.399af008.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><div class="announcementBar_3WsW" style="background-color:#090a11;color:#ffffff" role="banner"><div class="announcementBarContent_3EUC"><div><img src="/img/acryl-logo-white-mark.svg"><p><strong>Managed DataHub</strong><span> &nbsp;Acryl Data delivers an easy to consume DataHub platform for the enterprise</span></p></div> <a href="/managed" class="button button--primary">Sign up for Managed DataHub →</a></div></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/datahub-logo-color-light-horizontal.svg" alt="DataHub Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/datahub-logo-color-dark-horizontal.svg" alt="DataHub Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/docs/demo">Demo</a><a href="https://slack.datahubproject.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link item__icon item__slack" aria-label="Slack"></a><a href="https://github.com/linkedin/datahub" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link item__icon item__github" aria-label="GitHub"></a><a href="https://medium.com/datahub-project" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link item__icon item__medium" aria-label="Blog"></a><a href="https://www.youtube.com/channel/UC3qFQC5IiwR5fvWEqi_tJ5w" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link item__icon item__youtube" aria-label="YouTube"></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE" style="background-image:url(&quot;data:image/svg+xml,%3Csvg width=&#x27;18&#x27; height=&#x27;18&#x27; fill=&#x27;none&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%3E%3Cpath d=&#x27;M15.556 9.784A6.065 6.065 0 0 1 14 9.987a5.948 5.948 0 0 1-4.235-1.752 6.02 6.02 0 0 1-1.548-5.792.75.75 0 0 0-.918-.917A7.51 7.51 0 0 0 3.93 3.462c-2.924 2.924-2.924 7.682 0 10.607a7.453 7.453 0 0 0 5.304 2.198c2.003 0 3.886-.78 5.302-2.197a7.505 7.505 0 0 0 1.937-3.368.75.75 0 0 0-.918-.918Zm-2.079 3.225a5.96 5.96 0 0 1-4.242 1.758 5.964 5.964 0 0 1-4.243-1.758 6.009 6.009 0 0 1 0-8.486 5.942 5.942 0 0 1 1.545-1.112 7.52 7.52 0 0 0 2.167 5.886 7.479 7.479 0 0 0 5.886 2.168 6.026 6.026 0 0 1-1.113 1.544Z&#x27; fill=&#x27;%23fff&#x27; opacity=&#x27;.5&#x27;/%3E%3C/svg%3E&quot;);width:18px;height:18px;margin:-4px 0 0 -4px"> </span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE" style="background-image:url(&quot;data:image/svg+xml,%3Csvg width=&#x27;18&#x27; height=&#x27;18&#x27; fill=&#x27;none&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%3E%3Cg opacity=&#x27;.5&#x27; fill=&#x27;%23fff&#x27;%3E%3Cpath d=&#x27;M5.245 9A3.76 3.76 0 0 0 9 12.755 3.76 3.76 0 0 0 12.755 9 3.76 3.76 0 0 0 9 5.245 3.76 3.76 0 0 0 5.245 9ZM9 6.745A2.258 2.258 0 0 1 11.255 9 2.258 2.258 0 0 1 9 11.255 2.258 2.258 0 0 1 6.745 9 2.258 2.258 0 0 1 9 6.745Zm-.752 7.505h1.5v2.25h-1.5v-2.25Zm0-12.75h1.5v2.25h-1.5V1.5Zm-6.75 6.75h2.25v1.5h-2.25v-1.5Zm12.75 0h2.25v1.5h-2.25v-1.5ZM3.164 13.773l1.59-1.592 1.062 1.06-1.59 1.592-1.062-1.06ZM12.18 4.758l1.592-1.592 1.06 1.06-1.591 1.592-1.06-1.06ZM4.756 5.819l-1.59-1.592 1.06-1.06L5.818 4.76l-1.06 1.06ZM14.832 13.773l-1.06 1.06-1.592-1.591 1.06-1.06 1.592 1.59Z&#x27;/%3E%3C/g%3E%3C/svg%3E&quot;);width:18px;height:18px;margin:-4px 0 0 -4px"> </span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">DataHub</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Architecture</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Metadata Ingestion</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Metadata Modeling</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">GraphQL API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Developer Guides</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Components</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Advanced Guides</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Deployment</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Community</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/slack">Slack</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/links">Articles &amp; Talks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/townhalls">Town Halls</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/townhall-history">Town Hall History</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/code_of_conduct">Contributor Covenant Code of Conduct</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rfc">RFC Process</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">RFCs</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rfc/active/1778-dashboards">Dashboards</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rfc/active/1812-ml_models">Machine Learning Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rfc/active/1820-azkaban-flow-job">Azkaban Flows and Jobs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rfc/active/1841-lineage/field_level_lineage">RFC - Field Level Lineage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rfc/active/1842-business_glossary">Business Glossary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/rfc/active/2042-graphql_frontend/queries">GraphQL Frontend (Part 1)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rfc/active/2055-react-app">Proposal to Incubate a new React Application</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rfc/active/access-control/access-control">RBAC: Fine-grained Access Controls in DataHub</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rfc/active/tags">Tags</a></li></ul></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>GraphQL Frontend (Part 1)</h1></header><ul><li>Start Date: 12/17/2020</li><li>RFC PR: 2042</li><li>Implementation PR(s): 2044</li></ul><header><h1>GraphQL Frontend (Part 1)</h1></header><h2 class="anchor anchorWithStickyNavbar_31ik" id="summary">Summary<a aria-hidden="true" class="hash-link" href="#summary" title="Direct link to heading">​</a></h2><p>This RFC outlines a proposal to implement a GraphQL specification in <code>datahub-frontend</code>. Ultimately, this proposal aims to model the following using GraphQL:</p><ol><li>Reads against the Metadata Catalog (P1)</li><li>Writes against the Metadata Catalog (P2)</li><li>Auth, Search, &amp; Browse against the Metadata Catalog (P2) </li></ol><p>We propose that this initiative take place in phases, starting with CRUD-style read support against the entities, aspects, and relationships comprising the DataHub catalog. The scope of this RFC is limited to Part 1: reading against the catalog. It will cover the topics of introducing a dedicated GraphQL endpoint into <code>datahub-frontend</code> and provide a recipe for onboarding GMS entities to GQL. Subsequent RFCs will address writing, searching, and browsing against the catalog. </p><p>Along with the RFC, we&#x27;ve included a proof-of-concept demonstrating partial GQL read support, showcasing <code>Dataset</code> and its relationship to <code>CorpUser</code>. The following files will be useful to reference as you read along: </p><ul><li><code>datahub-frontend.graphql</code> - Where the GQL Schema is defined. </li><li><code>datahub-frontend/app/conf/routes</code> - Where the frontend API routes are defined.</li><li><code>datahub-frontend/app/controllers/GraphQLController.java</code> - The entry point for executing GQL queries. </li><li><code>datahub-frontend/app/graphql/resolvers</code> - Definition of GQL DataFetchers, discussed below. </li><li><code>datahub-dao</code> - Module containing the DAOs used in fetching downstream data from GMS</li></ul><p>It is important to note that there are some questions that would be best discussed among the community, especially those pertaining to modeling of the Metadata Catalog on the frontend. These will be covered in the <strong>Unresolved Questions</strong> section below.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="motivation">Motivation<a aria-hidden="true" class="hash-link" href="#motivation" title="Direct link to heading">​</a></h2><p>Exposing a GQL API for client-side apps has numerous benefits with respect to developer productivity, maintainability, performance among other things. This RFC will not attempt to fully enumerate the benefits of GraphQL as an IDL. For a more in-depth look at these advantages, <a href="https://www.apollographql.com/docs/intro/benefits/" target="_blank" rel="noopener noreferrer">this</a> is a good place to start.</p><p>We will provide a few reasons GraphQL is particularly suited for DataHub:</p><ul><li><strong>Reflects Reality</strong>: The metadata managed by DataHub can naturally be represented by a graph. Providing the ability to query it as such will not only lead to a more intuitive experience for client-side developers, but also provide more numerous opportunities for code reuse within both client side apps and the frontend server. </li><li><strong>Minimizes Surface Area</strong>: Different frontend use cases typically require differing quantities of information. This is shown by the numerous subresource endpoints exposed in the current api: <code>/datasets/urn/owners</code>, <code>/dataset/urn/institutionalmemory</code>, etc. Instead of requiring the creation of these endpoints individually, GraphQL allows the client to ask for exactly what it needs, in doing so reducing the number of endpoints that need to be maintained.  </li><li><strong>Reduces API Calls</strong>: Frontend apps are naturally oriented around pages, the data for which can typically be represented using a single document (view). DataHub is no exception. GraphQL allows frontend developers to easily materialize those views, without requiring complex frontend logic to coordinate multiple calls to the API.  </li></ul><h2 class="anchor anchorWithStickyNavbar_31ik" id="detailed-design">Detailed design<a aria-hidden="true" class="hash-link" href="#detailed-design" title="Direct link to heading">​</a></h2><p>This section will outline the changes required to introduce a GQL support within <code>datahub-frontend</code>, along with a description of how we can model GMA entities in the graph.</p><p>At a high level, the following changes will be made within <code>datahub-frontend</code>: </p><ol><li><p>Define a GraphQL Schema spec (datahub-frontend.graphql)</p></li><li><p>Configure a <code>/graphql</code> endpoint accepting POST requests (routes) </p></li><li><p>Introduce a dedicated <code>GraphQL</code> Play Controller</p><p>a. Configure GraphQL Engine</p><p>b. Parse, validate, &amp; prepare inbound queries</p><p>c. Execute Queries </p><p>d. Format &amp; send client response</p></li></ol><p>We will continue by taking a detailed look at each step. Throughout the design, we will reference the existing <code>Dataset</code> entity, its <code>Ownership</code> aspect, and its relationship to the <code>CorpUser</code> entity for purposes of illustration.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="defining-the-graphql-schema">Defining the GraphQL Schema<a aria-hidden="true" class="hash-link" href="#defining-the-graphql-schema" title="Direct link to heading">​</a></h3><p>GraphQL APIs must have a corresponding schema, representing the types &amp; relationships present in the graph. This is usually defined centrally within a <code>.graphql</code> file. We&#x27;ve introduced <code>datahub-frontend/app/conf/datahub-frontend.graphql</code>
for this purpose:</p><p><em>datahub-frontend.graphql</em></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly graphql"><pre tabindex="0" class="prism-code language-graphql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">schema</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">query</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Query</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Query</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">dataset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token attr-name" style="color:rgb(255, 203, 107)">urn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Dataset</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Dataset</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token attr-name" style="color:rgb(255, 203, 107)">urn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> String</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token operator" style="color:rgb(137, 221, 255)">...</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">CorpUser</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token attr-name" style="color:rgb(255, 203, 107)">urn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> String</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token operator" style="color:rgb(137, 221, 255)">...</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>There are two classes of object types within the GraphQL spec: <strong>user-defined</strong> types and <strong>system</strong> types. </p><p><strong>User-defined</strong> types model the entities &amp; relationships in your domain model. In the case of DataHub: Datasets, Users, Metrics, Schemas, &amp; more. These types can reference one another in composition, creating edges among types.</p><p><strong>System</strong> types include special &quot;root&quot; types which provide entry points to the graph:</p><ul><li><code>Query</code>: Reads against the graph (covered in RFC 2042)</li><li><code>Mutation</code>: Writes against the graph </li><li><code>Subscription</code>: Subscribing to changes within the graph</li></ul><p>In this design, we will focus on the <code>Query</code> type. Based on the types defined above, the following would be a valid GQL query: </p><p><em>Example Query</em></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly graphql"><pre tabindex="0" class="prism-code language-graphql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">query</span><span class="token plain"> datasets</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$urn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> String</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dataset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token attr-name" style="color:rgb(255, 203, 107)">urn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$urn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ownership </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           owner </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              username</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>For more details about the GraphQL Schemas &amp; Types, see <a href="https://graphql.org/learn/schema/" target="_blank" rel="noopener noreferrer">here</a>. </p><h3 class="anchor anchorWithStickyNavbar_31ik" id="configuring-a-graphql-endpoint">Configuring a GraphQL Endpoint<a aria-hidden="true" class="hash-link" href="#configuring-a-graphql-endpoint" title="Direct link to heading">​</a></h3><p>All GraphQL queries are serviced via a single endpoint. We place the new POST route in <code>datahub-frontend/conf/routes</code>:</p><p><code>POST          /api/v2/graphql                                                 react.controllers.GraphQLController.execute()</code></p><p>We also provide an implementation of a GraphQL Play Controller, exposing an &quot;execute&quot; method. The controller is responsible for </p><ul><li>parsing &amp; validating incoming queries</li><li>delegating execution of the query</li><li>formatting the client response</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="executing-a-query">Executing a Query<a aria-hidden="true" class="hash-link" href="#executing-a-query" title="Direct link to heading">​</a></h3><p>For executing queries, we will use the <a href="https://www.graphql-java.com/" target="_blank" rel="noopener noreferrer">graphql-java</a> library. </p><p>There are 2 components provided to the engine that enable execution:  </p><ol><li><p><strong>Data Resolvers</strong>: Resolve individual projections of a query. Defined for top-level entities and foreign key relationship fields</p></li><li><p><strong>Data Loaders</strong>: Efficiently load data required to resolve field(s) by aggregating calls to downstream data sources</p></li></ol><p><strong>Data Resolvers</strong></p><p>During read queries, the library &quot;resolves&quot; each field in the selection set of the query. It does so by intelligently invoking user-provided classes extending <code>DataFetcher</code>. These &#x27;resolvers&#x27; define how to fetch a particular field in the graph. Once implemented, &#x27;resolvers&#x27; must be registered with the query engine.</p><p>In DataHub&#x27;s case, resolvers will be required for</p><ul><li>Entities available for query (query type fields)</li><li>Relationships available for traversal (foreign-key fields)</li></ul><p><em>Defining resolvers</em> </p><p>Below you&#x27;ll find sample resolvers corresponding to</p><ul><li>the <code>dataset</code> query type defined above (query field resolver)</li><li>an <code>owner</code> field within the Ownership aspect (user-defined field resolver, foreign key reference)</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * Resolver responsible for resolving the &#x27;dataset&#x27; field of Query</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class DatasetResolver implements DataFetcher&lt;CompletableFuture&lt;Map&lt;String, Object&gt;&gt;&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public CompletableFuture&lt;Map&lt;String, Object&gt;&gt; get(DataFetchingEnvironment environment) throws Exception {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        final DataLoader&lt;String, Dataset&gt; dataLoader = environment.getDataLoader(&quot;datasetLoader&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return dataLoader.load(environment.getArgument(&quot;urn&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                .thenApply(RecordTemplate::data);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * Resolver responsible for resolving the &#x27;owner&#x27; field of Ownership.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class OwnerResolver implements DataFetcher&lt;CompletableFuture&lt;Map&lt;String, Object&gt;&gt;&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public CompletableFuture&lt;Map&lt;String, Object&gt;&gt; get(DataFetchingEnvironment environment) throws Exception {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        final Map&lt;String, Object&gt; parent = environment.getSource();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        final DataLoader&lt;String, CorpUser&gt; dataLoader = environment.getDataLoader(&quot;corpUserLoader&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return dataLoader.load((String) parent.get(&quot;owner&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                .thenApply(RecordTemplate::data);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Resolvers serve to load the correct data when requested by the GraphQL engine using the <code>get</code> method. Provided as input to resolvers include:</p><ul><li>parent field resolver result</li><li>optional arguments </li><li>optional context object</li><li>query variable map</li></ul><p>For a more detailed look of resolvers in graphql-java, check out the <a href="https://www.graphql-java.com/documentation/v11/data-fetching/" target="_blank" rel="noopener noreferrer">Data Fetching</a> documentation. </p><p><em>Registering resolvers</em></p><p>To register resolvers, we first construct a <code>RuntimeWiring</code> object provided by graphql-java: </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">private static RuntimeWiring configureResolvers() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /*</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * Register GraphQL field Resolvers.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return newRuntimeWiring()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /*</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * Query Resolvers</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    .type(&quot;Query&quot;, typeWiring -&gt; typeWiring</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .dataFetcher(&quot;dataset&quot;, new DatasetResolver())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /*</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * Relationship Resolvers</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    .type(&quot;Owner&quot;, typeWiring -&gt; typeWiring</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .dataFetcher(&quot;owner&quot;, new OwnerResolver())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    .build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This tells the engine which classes should be invoked to resolve which fields. </p><p>The <code>RuntimeWiring</code> object is then used to create a GraphQL engine: </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">GraphQLSchema graphQLSchema = schemaGenerator.makeExecutableSchema(typeDefinitionRegistry, configureResolvers());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">GraphQL engine = GraphQL.newGraphQL(graphQLSchema).build();</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You&#x27;ll notice within the resolvers we use <code>DataLoaders</code> to materialize the desired data. We&#x27;ll discuss these next. </p><p><strong>Data Loaders</strong></p><p>DataLoaders are an abstraction provided by <code>graphql-java</code> to make retrieval of data from downstream sources more efficient, by batching calls for the same data types.
DataLoaders are defined and registered with the GraphQL engine for each entity type to be loaded from a remote source. </p><p><em>Defining a DataLoader</em></p><p>Below you&#x27;ll find sample loaders corresponding to the <code>Dataset</code> and <code>CorpUser</code> GMA entities.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Create Dataset Loader</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BatchLoader&lt;String, com.linkedin.dataset.Dataset&gt; datasetBatchLoader = new BatchLoader&lt;String, com.linkedin.dataset.Dataset&gt;() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public CompletionStage&lt;List&lt;com.linkedin.dataset.Dataset&gt;&gt; load(List&lt;String&gt; keys) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return CompletableFuture.supplyAsync(() -&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                return DaoFactory.getDatasetsDao().getDatasets(keys);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            } catch (Exception e) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            throw new RuntimeException(&quot;Failed to batch load Datasets&quot;, e);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DataLoader datasetLoader = DataLoader.newDataLoader(datasetBatchLoader);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Create CorpUser Loader</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BatchLoader&lt;String, com.linkedin.identity.CorpUser&gt; corpUserBatchLoader = new BatchLoader&lt;String, com.linkedin.identity.CorpUser&gt;() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public CompletionStage&lt;List&lt;com.linkedin.identity.CorpUser&gt;&gt; load(List&lt;String&gt; keys) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return CompletableFuture.supplyAsync(() -&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                return DaoFactory.getCorpUsersDao().getCorpUsers(keys);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            } catch (Exception e) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                throw new RuntimeException(&quot;Failed to batch load CorpUsers&quot;, e);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">};</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DataLoader corpUserLoader = DataLoader.newDataLoader(corpUserBatchLoader);</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>In extending <code>BatchLoader</code>, a single batch &quot;load&quot; method must be provided. This API is exploited by the GraphQL engine, which aggregates calls for entities of the same type, reducing the number of downstream calls made within a single query. </p><p><em>Registering a DataLoader</em> </p><p>DataLoaders are registered with the <code>DataLoaderRegistry</code> and subsequently included as input to the GraphQL engine:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * Build DataLoader Registry</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DataLoaderRegistry registry = new DataLoaderRegistry();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">registry.register(&quot;datasetLoader&quot;, datasetLoader);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">registry.register(&quot;corpUserLoader&quot;, corpUserLoader);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * Construct execution input</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ExecutionInput executionInput = ExecutionInput.newExecutionInput()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">.query(queryJson.asText())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">.variables(variables)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">.dataLoaderRegistry(register)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">.build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * Execute GraphQL Query</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ExecutionResult executionResult = _engine.execute(executionInput);</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>For more information about <code>DataLoaders</code> see the <a href="https://www.graphql-java.com/documentation/v15/batching/" target="_blank" rel="noopener noreferrer">Using DataLoader</a> doc. </p><p>For a full reference implementation of the query execution process, see the  <code>GraphController.java</code> class associated with this PR. </p><h3 class="anchor anchorWithStickyNavbar_31ik" id="bonus-instrumentation">Bonus: Instrumentation<a aria-hidden="true" class="hash-link" href="#bonus-instrumentation" title="Direct link to heading">​</a></h3><p><a href="https://www.graphql-java.com/" target="_blank" rel="noopener noreferrer">graphql-java</a> provides an <a href="https://github.com/graphql-java/graphql-java/blob/master/src/main/java/graphql/execution/instrumentation/Instrumentation.java" target="_blank" rel="noopener noreferrer">Instrumentation</a> interface that can be implemented to record information about steps in the query execution process.</p><p>Conveniently, <code>graphql-java</code> provides a <code>TracingInstrumentation</code> implementation out of the box. This can be used to gain a deeper understanding of the performance of queries, by capturing granular (ie. field-level) tracing metrics for each query. This tracing information is included in the engine <code>ExecutionResult</code>. From there it can be sent to a remote monitoring service, logged, or simply provided as part of the GraphQL response.</p><p>For now, we will simply return the tracing results in the &quot;extensions&quot; portion of the GQL response, as described in <a href="https://github.com/apollographql/apollo-tracing" target="_blank" rel="noopener noreferrer">this doc</a>. In future designs, we can consider providing a more formal extension points for injecting custom remote monitoring logic. </p><h3 class="anchor anchorWithStickyNavbar_31ik" id="modeling-queries">Modeling Queries<a aria-hidden="true" class="hash-link" href="#modeling-queries" title="Direct link to heading">​</a></h3><p>The first phase of the GQL rollout will support primary-key lookups of GMA entities and projection of their associated aspects. In order to achieve this, we will</p><ul><li>model entities, aspects, and the relationships among them</li><li>expose queries against top-level entities
using GQL. </li></ul><p>The proposed steps for onboarding a GMA entity, it&#x27;s related aspects, and the relationships among them will be outlined next. </p><h4 class="anchor anchorWithStickyNavbar_31ik" id="1-model-an-entity-in-gql">1. <strong>Model an entity in GQL</strong><a aria-hidden="true" class="hash-link" href="#1-model-an-entity-in-gql" title="Direct link to heading">​</a></h4><p>The entity model should include its GMA aspects, as shown below, as simple object fields. The client will need not be intimately aware of the concept of &quot;aspects&quot;. Instead, it should be concerned with entities and their relationships.</p><p><em>Modeling Dataset</em></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly graphql"><pre tabindex="0" class="prism-code language-graphql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token description string language-markdown" style="color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)">Represents the GMA Dataset Entity</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)"></span><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Dataset</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">urn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> String</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">platform</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> String</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> String</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">origin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> FabricType</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">description</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> String</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">uri</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> String</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">platformNativeType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> PlatformNativeType</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">tags</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">properties</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">PropertyTuple</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">createdTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Long</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">modifiedTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Long</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">ownership</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ownership</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token description string language-markdown" style="color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)">Represents Ownership</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)"></span><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Ownership</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">owners</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">Owner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">lastModified</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Long</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token description string language-markdown" style="color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)">Represents an Owner</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)"></span><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Owner</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token description string language-markdown" style="color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)">     The fully-resolved owner</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)">    </span><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">owner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> CorpUser</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token description string language-markdown" style="color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)">     The type of the ownership</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)">    </span><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> OwnershipType</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token description string language-markdown" style="color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)">     Source information for the ownership</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)">    </span><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">source</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> OwnershipSource</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Notice that the Dataset&#x27;s <code>Ownership</code> aspect includes a nested <code>Owner</code> field that references a <code>CorpUser</code> type. In the GMS model, this is represented as a foreign-key relationship (urn). In GraphQL, we include the <em>resolved</em> relationship, allowing the client to easily retrieve information about a Dataset&#x27;s owners.</p><p>To support traversal of this relationship, we additionally include a <code>CorpUser</code> type:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly graphql"><pre tabindex="0" class="prism-code language-graphql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token description string language-markdown" style="color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)">Represents the CorpUser GMA Entity</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)"></span><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">CorpUser</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">urn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> String</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">username</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> String</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">info</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> CorpUserInfo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">editableInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> CorpUserEditableInfo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_31ik" id="2-extend-the-query-type">2. <strong>Extend the &#x27;Query&#x27; type</strong>:<a aria-hidden="true" class="hash-link" href="#2-extend-the-query-type" title="Direct link to heading">​</a></h4><p>GraphQL defines a top-level &#x27;Query&#x27; type that serves as the entry point for reads against the graph. This is extended to support querying the new entity type.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly graphql"><pre tabindex="0" class="prism-code language-graphql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Query</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">dataset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token attr-name" style="color:rgb(255, 203, 107)">urn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> String</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Dataset </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Add this! </span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">datasets</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token attr-name" style="color:rgb(255, 203, 107)">urn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">Dataset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Or if batch support required, add this! </span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_31ik" id="3-define--register-dataloaders">3. <strong>Define &amp; Register DataLoaders</strong><a aria-hidden="true" class="hash-link" href="#3-define--register-dataloaders" title="Direct link to heading">​</a></h4><p>This is illustrated in the previous section. It involves extending <code>DataLoader</code> and registering the loader in the <code>DataLoaderRegistry</code>.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="4-define--register-datafetcher-data-resolver">4. <strong>Define &amp; Register DataFetcher (Data Resolver)</strong><a aria-hidden="true" class="hash-link" href="#4-define--register-datafetcher-data-resolver" title="Direct link to heading">​</a></h4><p>This is illustrated in the previous section. It involves implementing the DataFetcher interface and attaching it to fields in the graph.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="5-query-your-new-entity">5. <strong>Query your new entity</strong><a aria-hidden="true" class="hash-link" href="#5-query-your-new-entity" title="Direct link to heading">​</a></h4><p>Deploy &amp; start issuing queries against the graph. </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly graphql"><pre tabindex="0" class="prism-code language-graphql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Input</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">query</span><span class="token plain"> datasets</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$urn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> String</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dataset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token attr-name" style="color:rgb(255, 203, 107)">urn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$urn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        urn </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ownership </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            owners </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                owner </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    username</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Output </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;data&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;dataset&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;urn&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;urn:li:dataset:(urn:li:dataPlatform:foo,bar,PROD)&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ownership&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;owners&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;owner&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;username&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;james joyce&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Disclaimer</strong></p><p>It is the intention that the GraphQL type system be <strong>auto-generated</strong> based on the PDL models declared at the GMA layer. This means that the frontend schema should need not be maintained separately from the GMA it is derived from. </p><p>Various changes will be required to accomplish this:</p><ol><li>Introduce <code>readOnly</code> annotation into GMA PDLs used to identify which field should <em>not</em> be writable.</li><li>Introduce <code>relationship</code> annotation into GMA PDLs used to declare foreign-key relationships (alternate to the relationship + pairings convention that exists today)</li><li>Implement a GraphQL schema generator that can be configured to <ul><li>Load relevant entity PDLs</li><li>Generate <code>Query</code> types, including resolved relationships</li><li>Generate <code>Mutation</code> types, omitting specific fields </li><li>Write generated types to GraphQL schema file </li><li>Run as a build-time gradle task</li></ul></li></ol><p>We omit proposal of this portion of the design from this RFC. There will be a subsequent RFC proposing implementation of the items above.</p><p>*Auto-generated GQL resolvers generation should also be explored. This would be possible provided that standardized DAOs are available at the frontend service layer. It&#x27;d be incredible if we could</p><ul><li>Auto generate &quot;client&quot; objects from a rest spec</li><li>Auto generate &quot;dao&quot; objects that use a client</li><li>Auto generate &quot;resolvers&quot; that use a &quot;dao&quot; </li></ul><h2 class="anchor anchorWithStickyNavbar_31ik" id="how-we-teach-this">How we teach this<a aria-hidden="true" class="hash-link" href="#how-we-teach-this" title="Direct link to heading">​</a></h2><p>We will create user guides that cover: </p><ul><li>Modeling &amp; onboarding entities to the GQL type system</li><li>Modeling &amp; onboarding entity aspects to the GQL type system</li><li>Modeling &amp; onboarding relationships among entities to the GQL type system </li></ul><h2 class="anchor anchorWithStickyNavbar_31ik" id="alternatives">Alternatives<a aria-hidden="true" class="hash-link" href="#alternatives" title="Direct link to heading">​</a></h2><p>Keep the resource-oriented approach, with different endpoints for each entity / aspect. </p><h2 class="anchor anchorWithStickyNavbar_31ik" id="rollout--adoption-strategy">Rollout / Adoption Strategy<a aria-hidden="true" class="hash-link" href="#rollout--adoption-strategy" title="Direct link to heading">​</a></h2><ol><li>Rollout CRUD-style reads against entities / aspects in the graph<ul><li>Entities: Dataset, CorpUser, DataPlatform</li><li>Relationships: Dataset-&gt;CorpUser, Dataset-&gt;DataPlatform, <!-- -->[if there is demand]<!-- --> CorpUser -&gt; Dataset</li></ul></li><li>Rollout CRUD-style writes against entities / aspects in the graph</li><li>Rollout full text search against entities / aspects in the graph</li><li>Rollout browse against entities / aspects in the graph</li><li>Migrate client-side apps to leverage new GraphQL API <ul><li>Build out parallel data fecthing layer, where the existing models are populated either by the old clients or the new GQL clients. Place this behind a client-side feature flag. </li><li>Allow users of DataHub to configure which API they want to run with, swap at their own pace.</li></ul></li></ol><h2 class="anchor anchorWithStickyNavbar_31ik" id="unresolved-questions">Unresolved questions<a aria-hidden="true" class="hash-link" href="#unresolved-questions" title="Direct link to heading">​</a></h2><p><strong>How should aspects be modeled on the GQL Graph?</strong></p><p>Aspects should be modeled as nothing more than fields on their parent entity. The frontend clients should not require understanding of the aspect concept. Instead, fetching specific aspects should be a matter of querying the parent entities with particular projections. </p><p>For example, retrieving the <code>Ownership</code> aspect of <code>Datasets</code> is done using the following GQL query:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly graphql"><pre tabindex="0" class="prism-code language-graphql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">query</span><span class="token plain"> datasets</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$urn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> String</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dataset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token attr-name" style="color:rgb(255, 203, 107)">urn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$urn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ownership </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            owners </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                owner </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    username</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>as opposed to the following: </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly graphql"><pre tabindex="0" class="prism-code language-graphql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">query</span><span class="token plain"> ownership</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$datasetUrn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> String</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ownership</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token attr-name" style="color:rgb(255, 203, 107)">datasetUrn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$datasetUrn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        owners </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            owner </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                username</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Aspects should not be exposed in the top-level &#x27;Query&#x27; model. </p><p><strong>What should the GraphQL graph model contain? How should it be constructed?</strong></p><p>There are 2 primary options: </p><ol><li>Directly expose transposed GMS models (entities, aspects as is) via the GQL type system. One alteration would be introducing resolved relationships extending outward from the aspect objects.</li></ol><ul><li>Pros: Simpler because no new POJOs need to be maintained at the <code>datahub-frontend</code> layer (can reuse the Rest.li models provided by GMS). In the longer term, GQL type system can be generated directly from GMS Pegasus models.</li><li>Cons: Exposes frontend clients to the entire GMA graph, much of which may not be useful for presentation</li></ul><ol start="2"><li>Create a brand new presentation-layer Graph model</li></ol><ul><li>Pros: Only expose what frontend clients need from the graph (simplifies topology)</li><li>Cons: Requires that we maintain (perhaps generate) additional POJOs specific to the presentation layer (maintenance cost?)</li></ul><p>We&#x27;re interested to get community feedback on this question! </p><p><strong>Should foreign-keys corresponding to outbound relationships be included in the GQL schema?</strong></p><p>Using the example from above, that would entail a model like: </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly graphql"><pre tabindex="0" class="prism-code language-graphql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token description string language-markdown" style="color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)">Represents an Owner</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)"></span><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Owner</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token description string language-markdown" style="color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)">    Owner URN, e.g. urn:li:corpuser:ldap, urn:li:corpGroup:group_name, and urn:li:product:product_name</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)">    </span><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">ownerUrn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> String</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token description string language-markdown" style="color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)">    The fully resolved owner!</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)">    </span><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">owner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> CorpUser</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token description string language-markdown" style="color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)">     The type of the ownership</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)">    </span><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> OwnershipType</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token description string language-markdown" style="color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)">     Source information for the ownership</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token description string language-markdown" style="color:rgb(195, 232, 141)">    </span><span class="token description string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token attr-name" style="color:rgb(255, 203, 107)">source</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> OwnershipSource</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>We should <em>not</em> need to include such fields. This is because we can efficiently implement the following query:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly graphql"><pre tabindex="0" class="prism-code language-graphql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">query</span><span class="token plain"> datasets</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$urn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> String</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dataset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token attr-name" style="color:rgb(255, 203, 107)">urn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$urn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        urn </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ownership </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            owners </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                owner </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    urn</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>without actually calling downstream services. By cleverly implementing the &quot;owner&quot; field resolver, we can return quickly when the urn is the only projection:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* GraphQL Resolver responsible for fetching Dataset owners.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  public class OwnerResolver implements DataFetcher&lt;CompletableFuture&lt;Map&lt;String, Object&gt;&gt;&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      @Override</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      public CompletableFuture&lt;Map&lt;String, Object&gt;&gt; get(DataFetchingEnvironment environment) throws Exception {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          final Map&lt;String, Object&gt; parent = environment.getSource();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          if (environment.getSelectionSet().contains(&quot;urn&quot;) &amp;&amp; environment.getSelectionSet().getFields().size() == 1) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if (parent.get(&quot;owner&quot;) != null) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               return CompletableFuture.completedFuture(ImmutableMap.of(&quot;urn&quot;, parent.get(&quot;owner&quot;))) </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          ... else load as normal </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>How can I play with these changes?</strong></p><ol><li>Apply changes from this branch locally</li><li>Launch datahub-gms &amp; dependencies &amp; populate with some data as usual</li><li>Launch <code>datahub-frontend</code> server using <code>cd datahub-frontend/run &amp;&amp; ./run-local-frontend</code>.</li><li>Authenticate yourself at http://localhost:9001 (username: datahub) and extract the PLAY_SESSION cookie that is set in your browser.  </li><li>Issue a GraphQL query using CURL or a tool like Postman. For example:</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl --location --request POST &#x27;http://localhost:9001/api/v2/graphql&#x27; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--header &#x27;X-RestLi-Protocol-Version: 2.0.0&#x27; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--header &#x27;Content-Type: application/json&#x27; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--header &#x27;Cookie: PLAY_SESSION=&lt;your-cookie-here&gt;&#x27; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--data-raw &#x27;{&quot;query&quot;:&quot;query datasets($urn: String!) { </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\n    dataset(urn: $urn) { </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\n        urn </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\n        ownership {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\n            owners {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\n                owner {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\n                    username</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\n                    info {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\n                        manager {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\n                            username </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\n                        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\n                    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\n                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\n                type</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\n                source {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\n                    type</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\n                    url</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\n                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\n            }\n        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\n        platform</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\n    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\n}&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;variables&quot;:{&quot;urn&quot;:&quot;&lt;your dataset urn&gt;&quot;}}&#x27;```</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/linkedin/datahub/blob/master/docs/rfc/active/2042-graphql_frontend/queries.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/rfc/active/1842-business_glossary"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« <!-- -->Business Glossary</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/rfc/active/2055-react-app"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Proposal to Incubate a new React Application<!-- --> »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li><li><a href="#motivation" class="table-of-contents__link toc-highlight">Motivation</a></li><li><a href="#detailed-design" class="table-of-contents__link toc-highlight">Detailed design</a><ul><li><a href="#defining-the-graphql-schema" class="table-of-contents__link toc-highlight">Defining the GraphQL Schema</a></li><li><a href="#configuring-a-graphql-endpoint" class="table-of-contents__link toc-highlight">Configuring a GraphQL Endpoint</a></li><li><a href="#executing-a-query" class="table-of-contents__link toc-highlight">Executing a Query</a></li><li><a href="#bonus-instrumentation" class="table-of-contents__link toc-highlight">Bonus: Instrumentation</a></li><li><a href="#modeling-queries" class="table-of-contents__link toc-highlight">Modeling Queries</a></li></ul></li><li><a href="#how-we-teach-this" class="table-of-contents__link toc-highlight">How we teach this</a></li><li><a href="#alternatives" class="table-of-contents__link toc-highlight">Alternatives</a></li><li><a href="#rollout--adoption-strategy" class="table-of-contents__link toc-highlight">Rollout / Adoption Strategy</a></li><li><a href="#unresolved-questions" class="table-of-contents__link toc-highlight">Unresolved questions</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/quickstart">Quickstart</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/features">Features</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/faq">FAQs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://slack.datahubproject.io" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UC3qFQC5IiwR5fvWEqi_tJ5w" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/townhalls">Town Halls</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/#adoption">Adoption</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/demo">Demo</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/roadmap">Roadmap</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/contributing">Contributing</a></li><li class="footer__item"><a href="https://github.com/linkedin/datahub" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2015-2021 DataHub Project Authors.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.e06da938.js"></script>
<script src="/assets/js/main.399af008.js"></script>
</body>
</html>