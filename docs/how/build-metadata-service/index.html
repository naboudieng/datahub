<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.2">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2G54RXWD4D"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-2G54RXWD4D",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="DataHub" href="/opensearch.xml"><title data-react-helmet="true">Metadata Service Developer Guide | DataHub</title><meta data-react-helmet="true" property="og:url" content="https://datahubproject.io/docs/how/build-metadata-service"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Metadata Service Developer Guide | DataHub"><meta data-react-helmet="true" name="description" content="This guide assumes that you are already familar with the architecture of DataHub&#x27;s Metadata Serving Layer, as described here."><meta data-react-helmet="true" property="og:description" content="This guide assumes that you are already familar with the architecture of DataHub&#x27;s Metadata Serving Layer, as described here."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://datahubproject.io/docs/how/build-metadata-service"><link data-react-helmet="true" rel="alternate" href="https://datahubproject.io/docs/how/build-metadata-service" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://datahubproject.io/docs/how/build-metadata-service" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.1de1be40.css">
<link rel="preload" href="/assets/js/runtime~main.16e849ac.js" as="script">
<link rel="preload" href="/assets/js/main.56abecf9.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo-color.png" alt="DataHub Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo-dark.png" alt="DataHub Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">DataHub</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/docs/demo">Demo</a><a href="https://slack.datahubproject.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/linkedin/datahub" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a class="navbar__item navbar__link navbar-saas-button button button--primary" href="/docs/saas">SaaS</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">üåû</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo-color.png" alt="DataHub Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo-dark.png" alt="DataHub Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">DataHub</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/demo">Demo</a></li><li class="menu__list-item"><a href="https://slack.datahubproject.io" target="_blank" rel="noopener noreferrer" class="menu__link"><span>Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a href="https://github.com/linkedin/datahub" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a class="menu__link navbar-saas-button button button--primary" href="/docs/saas">SaaS</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><main class="docMainContainer_3ufF docMainContainerEnhanced_3NYZ"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">Metadata Service Developer Guide</h1></header><p>This guide assumes that you are already familar with the architecture of DataHub&#x27;s Metadata Serving Layer, as described <a href="/docs/architecture/metadata-serving">here</a>. </p><p>Read on to understand how to build and extend the DataHub service tier for your specific needs.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="using-daos-to-store-and-query-metadata"></a>Using DAOs to store and query Metadata<a class="hash-link" href="#using-daos-to-store-and-query-metadata" title="Direct link to heading">#</a></h2><p>DataHub metadata service uses the excellent <code>datahub-gma</code> library to store and query metadata in a standard way.
There are four types of Data Access Objects (<a href="https://en.wikipedia.org/wiki/Data_access_object" target="_blank" rel="noopener noreferrer">DAO</a>) that standardize the way metadata is accessed.
This section describes each type of DAO, its purpose, and the interface. </p><p>These DAOs rely heavily on <a href="https://docs.oracle.com/javase/tutorial/extra/generics/index.html" target="_blank" rel="noopener noreferrer">Java Generics</a> so that the core logics can remain type-neutral.
However, as there‚Äôs no inheritance in <a href="https://linkedin.github.io/rest.li/pdl_schema" target="_blank" rel="noopener noreferrer">Pegasus</a>, the generics often fallback to extending <a href="https://github.com/linkedin/rest.li/blob/master/data/src/main/java/com/linkedin/data/template/RecordTemplate.java" target="_blank" rel="noopener noreferrer">RecordTemplate</a> instead of the desired types (i.e. <a href="/docs/what/entity">entity</a>, <a href="/docs/what/relationship">relationship</a>, metadata <a href="/docs/what/aspect">aspect</a> etc). Additional runtime type checking has been added to the DAOs to avoid binding to unexpected types. We also cache the type checking result to minimize runtime overhead.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="key-value-dao-local-dao"></a>Key-value DAO (Local DAO)<a class="hash-link" href="#key-value-dao-local-dao" title="Direct link to heading">#</a></h3><p><a href="/docs/what/gms">GMS</a> use <a href="https://github.com/linkedin/datahub/blob/master/metadata-dao/src/main/java/com/linkedin/metadata/dao/BaseLocalDAO.java" target="_blank" rel="noopener noreferrer">Local DAO</a> to store and retrieve metadata <a href="/docs/what/aspect">aspect</a>s from the local document store.
Below shows the base class and its simple key-value interface.
As the DAO is a generic class, it needs to be bound to specific type during instantiation.
Each entity type will need to instantiate its own version of DAO.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">public abstract class BaseLocalDAO&lt;ASPECT extends UnionTemplate&gt; {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> public abstract &lt;URN extends Urn, METADATA extends RecordTemplate&gt; void </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  add(Class&lt;METADATA&gt; type, URN urn, METADATA value);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> public abstract &lt;URN extends Urn, METADATA extends RecordTemplate&gt; </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Optional&lt;METADATA&gt; get(Class&lt;METADATA&gt; type, URN urn, int version);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> public abstract &lt;URN extends Urn, METADATA extends RecordTemplate&gt; </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ListResult&lt;Integer&gt; listVersions(Class&lt;METADATA&gt; type, URN urn, int start, </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    int pageSize);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> public abstract &lt;METADATA extends RecordTemplate&gt; ListResult&lt;Urn&gt; listUrns( </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Class&lt;METADATA&gt; type, int start, int pageSize);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> public abstract &lt;URN extends Urn, METADATA extends RecordTemplate&gt; </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ListResult&lt;METADATA&gt; list(Class&lt;METADATA&gt; type, URN urn, int start, int pageSize);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Another important function of <a href="https://github.com/linkedin/datahub/blob/master/metadata-dao/src/main/java/com/linkedin/metadata/dao/BaseLocalDAO.java" target="_blank" rel="noopener noreferrer">Local DAO</a> is to automatically emit <a href="/docs/what/mxe#metadata-audit-event-mae">MAE</a>s whenever the metadata is updated.
This is doable because MAE effectively use the same <a href="https://linkedin.github.io/rest.li/pdl_schema" target="_blank" rel="noopener noreferrer">Pegasus</a> models so <a href="https://github.com/linkedin/rest.li/blob/master/data/src/main/java/com/linkedin/data/template/RecordTemplate.java" target="_blank" rel="noopener noreferrer">RecordTemplate</a> can be easily converted into the corresponding <a href="https://github.com/apache/avro/blob/master/lang/java/avro/src/main/java/org/apache/avro/generic/GenericRecord.java" target="_blank" rel="noopener noreferrer">GenericRecord</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="search-dao"></a>Search DAO<a class="hash-link" href="#search-dao" title="Direct link to heading">#</a></h3><p>Search DAO is also a generic class that can be bound to a specific type of search document.
The DAO provides 3 APIs:</p><ul><li>A <code>search</code> API that takes the search input, a <a href="https://github.com/linkedin/datahub/blob/master/metadata-dao/src/main/pegasus/com/linkedin/metadata/query/Filter.pdl" target="_blank" rel="noopener noreferrer">Filter</a>, a <a href="https://github.com/linkedin/datahub/blob/master/metadata-dao/src/main/pegasus/com/linkedin/metadata/query/SortCriterion.pdl" target="_blank" rel="noopener noreferrer">SortCriterion</a>, some pagination parameters, and returns a <a href="https://github.com/linkedin/datahub/blob/master/metadata-dao/src/main/java/com/linkedin/metadata/dao/SearchResult.java" target="_blank" rel="noopener noreferrer">SearchResult</a>. </li><li>An <code>autoComplete</code> API which allows typeahead-style autocomplete based on the current input and a <a href="https://github.com/linkedin/datahub/blob/master/metadata-dao/src/main/pegasus/com/linkedin/metadata/query/Filter.pdl" target="_blank" rel="noopener noreferrer">Filter</a>, and returns <a href="https://github.com/linkedin/datahub/blob/master/metadata-dao/src/main/pegasus/com/linkedin/metadata/query/AutoCompleteResult.pdl" target="_blank" rel="noopener noreferrer">AutocompleteResult</a>.</li><li>A <code>filter</code> API which allows for filtering only without a search input. It takes a a <a href="https://github.com/linkedin/datahub/blob/master/metadata-dao/src/main/pegasus/com/linkedin/metadata/query/Filter.pdl" target="_blank" rel="noopener noreferrer">Filter</a> and a <a href="https://github.com/linkedin/datahub/blob/master/metadata-dao/src/main/pegasus/com/linkedin/metadata/query/SortCriterion.pdl" target="_blank" rel="noopener noreferrer">SortCriterion</a> as input and returns <a href="https://github.com/linkedin/datahub/blob/master/metadata-dao/src/main/java/com/linkedin/metadata/dao/SearchResult.java" target="_blank" rel="noopener noreferrer">SearchResult</a>.</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">public abstract class BaseSearchDAO&lt;DOCUMENT extends RecordTemplate&gt; {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  public abstract SearchResult&lt;DOCUMENT&gt; search(String input, Filter filter, </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        SortCriterion sortCriterion, int from, int size);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  public abstract AutoCompleteResult autoComplete(String input, String field,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Filter filter, int limit);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  public abstract SearchResult&lt;DOCUMENT&gt; filter(Filter filter, SortCriterion sortCriterion, </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        int from, int size);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="query-dao"></a>Query DAO<a class="hash-link" href="#query-dao" title="Direct link to heading">#</a></h3><p>Query DAO allows clients, e.g. <a href="/docs/what/gms">GMS</a>, <a href="/docs/architecture/metadata-serving#metadata-index-applier-mae-consumer-job">MAE Consumer Job</a> etc, to perform both graph &amp; non-graph queries against the metadata graph.
For instance, a GMS can use the Query DAO to find out ‚Äúall the dataset owned by the users who is part of the group <code>foo</code> and report to <code>bar</code>,‚Äù which naturally translates to a graph query.
Alternatively, a client may wish to retrieve ‚Äúall the datasets that stored under /jobs/metrics‚Äù, which doesn‚Äôt involve any graph traversal.</p><p>Below is the base class for Query DAOs, which contains the <code>findEntities</code> and <code>findRelationships</code> methods.
Both methods also have two versions, one involves graph traversal, and the other doesn‚Äôt.
You can use <code>findMixedTypesEntities</code> and <code>findMixedTypesRelationships</code> for queries that return a mixture of different types of entities or relationships.
As these methods return a list of <a href="https://github.com/linkedin/rest.li/blob/master/data/src/main/java/com/linkedin/data/template/RecordTemplate.java" target="_blank" rel="noopener noreferrer">RecordTemplate</a>, callers will need to manually cast them back to the specific entity type using <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Class.html#isInstance-java.lang.Object-" target="_blank" rel="noopener noreferrer">isInstance()</a> or reflection.</p><p>Note that the generics (ENTITY, RELATIONSHIP) are purposely left untyped, as these types are native to the underlying graph DB and will most likely differ from one implementation to another.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">public abstract class BaseQueryDAO&lt;ENTITY, RELATIONSHIP&gt; {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> public abstract &lt;ENTITY extends RecordTemplate&gt; List&lt;ENTITY&gt; findEntities(</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Class&lt;ENTITY&gt; type, Filter filter, int offset, int count);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> public abstract &lt;ENTITY extends RecordTemplate&gt; List&lt;ENTITY&gt; findEntities(</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Class&lt;ENTITY&gt; type, Statement function);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> public abstract List&lt;RecordTemplate&gt; findMixedTypesEntities(Statement function);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> public abstract &lt;ENTITY extends RecordTemplate, RELATIONSHIP extends RecordTemplate&gt; List&lt;RELATIONSHIP&gt; </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  findRelationships(Class&lt;ENTITY&gt; entityType, Class&lt;RELATIONSHIP&gt; relationshipType, Filter filter, int offset, int count);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> public abstract &lt;RELATIONSHIP extends RecordTemplate&gt; List&lt;RELATIONSHIP&gt; </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  findRelationships(Class&lt;RELATIONSHIP&gt; type, Statement function);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> public abstract List&lt;RecordTemplate&gt; findMixedTypesRelationships(</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Statement function);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="remote-dao"></a>Remote DAO<a class="hash-link" href="#remote-dao" title="Direct link to heading">#</a></h3><p><a href="https://github.com/linkedin/datahub/blob/master/metadata-dao/src/main/java/com/linkedin/metadata/dao/BaseRemoteDAO.java" target="_blank" rel="noopener noreferrer">Remote DAO</a> is nothing but a specialized readonly implementation of <a href="https://github.com/linkedin/datahub/blob/master/metadata-dao/src/main/java/com/linkedin/metadata/dao/BaseLocalDAO.java" target="_blank" rel="noopener noreferrer">Local DAO</a>.
Rather than retrieving metadata from a local storage, Remote DAO will fetch the metadata from another <a href="/docs/what/gms">GMS</a>.
The mapping between <a href="/docs/what/entity">entity</a> type and GMS is implemented as a hard-coded map.</p><p>To prevent circular dependency (<a href="https://rest.li" target="_blank" rel="noopener noreferrer">rest.li</a> service depends on remote DAO, which in turn depends on rest.li client generated by each rest.li service),
Remote DAO will need to construct raw rest.li requests directly, instead of using each entity‚Äôs rest.li request builder.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="customizing-search-and-graph-index-updates"></a>Customizing Search and Graph Index Updates<a class="hash-link" href="#customizing-search-and-graph-index-updates" title="Direct link to heading">#</a></h2><p>In addition to storing and querying metadata, a common requirement is to customize and extend the fields that are being stored in the search or the graph index. </p><p>As described in <a href="/docs/metadata-modeling/metadata-model">Metadata Modelling</a> section, <a href="/docs/what/entity">Entity</a>, <a href="/docs/what/relationship">Relationship</a>, and <a href="/docs/what/search-document">Search Document</a> models do not directly encode the logic of how each field should be derived from metadata.
Instead, this logic needs to be provided in the form of a Java class: a graph or search index builder.</p><p>The builders register the <a href="/docs/what/aspect">metadata aspect</a>s of their interest against <a href="#mae-consumer-job">MAE Consumer Job</a> and will be invoked whenever a MAE involving the corresponding aspect is received.
If the MAE itself doesn‚Äôt contain all the metadata needed, builders can use Remote DAO to fetch from GMS directly.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">public abstract class BaseIndexBuilder&lt;DOCUMENT extends RecordTemplate&gt; {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BaseIndexBuilder(@Nonnull List&lt;Class&lt;? extends RecordTemplate&gt;&gt; snapshotsInterested);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> @Nullable</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> public abstract List&lt;DOCUMENT&gt; getDocumentsToUpdate(@Nonnull RecordTemplate snapshot);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> @Nonnull</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> public abstract Class&lt;DOCUMENT&gt; getDocumentType();</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">public interface GraphBuilder&lt;SNAPSHOT extends RecordTemplate&gt; {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> GraphUpdates build(SNAPSHOT snapshot);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> @Value</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> class GraphUpdates {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   List&lt;? extends RecordTemplate&gt; entities;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   List&lt;RelationshipUpdates&gt; relationshipUpdates;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> @Value</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> class RelationshipUpdates {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   List&lt;? extends RecordTemplate&gt; relationships;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   BaseGraphWriterDAO.RemovalOption preUpdateOperation;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/linkedin/datahub/blob/master/docs/how/build-metadata-service.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#using-daos-to-store-and-query-metadata" class="table-of-contents__link">Using DAOs to store and query Metadata</a><ul><li><a href="#key-value-dao-local-dao" class="table-of-contents__link">Key-value DAO (Local DAO)</a></li><li><a href="#search-dao" class="table-of-contents__link">Search DAO</a></li><li><a href="#query-dao" class="table-of-contents__link">Query DAO</a></li><li><a href="#remote-dao" class="table-of-contents__link">Remote DAO</a></li></ul></li><li><a href="#customizing-search-and-graph-index-updates" class="table-of-contents__link">Customizing Search and Graph Index Updates</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/quickstart">Quickstart</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/features">Features</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/faq">FAQs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://slack.datahubproject.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UC3qFQC5IiwR5fvWEqi_tJ5w" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/townhalls">Town Halls</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/#adoption">Adoption</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/demo">Demo</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/roadmap">Roadmap</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/contributing">Contributing</a></li><li class="footer__item"><a href="https://github.com/linkedin/datahub" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2015-2021 DataHub Project Authors.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.16e849ac.js"></script>
<script src="/assets/js/main.56abecf9.js"></script>
</body>
</html>